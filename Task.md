# Тестовое на PHP

Нужно сделать простое REST api:

# Стуктура БД
должно быть две таблицы: 
1. user(id,email,name,password_hash,activated,created_at)
2. confirmation_token(id,value,user_id)
# Методы API

## POST /api/sign_up - регистраци нового пользователя
1. запрос должен принимать 
    1. имя
    2. email
    3. пароль
3. Email должен быть уникальным, если такой email уже есть в системе,то метод должен вернуть HTTP status 400 с описанием ошибки
4. При успешном сценарии:
    1. Новый пользователь должен сохраниться в БД в неактивированном состоянии
    2. должен сгенерироваться confirmationToken для подтверждения регистрации (на email отправлять не нужно)
    3. Метод возвращает HTTP status 201 с пустым телом
## POST /api/confirm_email - подтверждение регистрации
1. запрос должен принимать 
    1. confirmationToken (который сгенерировался при регистрации пользователя)
2. Если confirmationToken не найден, то метод должен вернуть HTTP status 400 с описанием ошибки
3. При успешном сценарии:
    1. Пользователь активируется
    2. confirmationToken удаляется
    3. Метод возвращает HTTP status 201 с пустым телом
    

## POST /api/sign_in - аутентификация пользователя 
1. Запрос должен принимать:
    1. email
    2. пароль
3. Если такой связки email+password нет в системе, метод должен вернуть HTTP status 401 с описанием ошибки
4. Если email не подтвержден, метод должен вернуть HTTP status 401 с описанием ошибки
5. При успешном сценарии метод должен вернуть JWT токен (в токене должна быть зашита информация с id,email пользователя и дата генерации токена)

## GET /api/profile - профиль пользователя
1. Метод должен принимать JWT токен в заголовке Authorization для авторизации пользователя
2. Если JWT токен не передан метод должен возвращать HTTP status 403 с описанием ошибки
3. При успешном сценарии метод должен вернуть имя, email и дату создания пользователя на основе id который зашит в JWT токене

## Требования

1. Приложение должно быть сделано на основе PSR-7 МИКРО фреймворке (Mezzio,Slim и тд)
2. Для управления БД нужно использовать DBAL (https://www.doctrine-project.org/projects/doctrine-dbal/en/2.10/index.html) либо Doctrine (https://www.doctrine-project.org/projects/orm.html). Использование Doctrine будет плюсом
3. В проекте должна быть одна миграция для инициализации БД (https://www.doctrine-project.org/projects/migrations.html)
4. Должны быть функциональные тесты на все четыре метода API
5. Для удобства разработки можно использовать любые пакеты composer (например для генерации JWT токена https://github.com/firebase/php-jwt)
6. Все запросы/ответы должны быть в json 